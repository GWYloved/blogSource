---
title: "长安车机性能优化小结"
date: 2019-09-29T23:33:55+08:00

---

# 背景

长安桑德B211的车机是最近一直在忙的一个项目。

这个项目刚开始反馈是说车机十分卡顿，点击无效等。

在6-7月份的时候做了一版基于内存方面的优化，主要做的是glide加载，对部分new出来的bitmap做复用等等。

当时那一版因为有些操作涉及到了用户体验，例如说去除内存缓存，降低图片质量，减小图片缓存池大小等，因此做了一些开关。

开关是基于Facebook的一个叫做deviceyear的一个工具类，主要是判断内存，cpu核数，cpu频率等做的一个比较综合的判断。

当时的优化结果是内存方面启动内存降低了20%，运行内存降低了20-40%的样子。

但是B211这个项目很奇怪，包发过去之后反馈是仍然很卡，只是稍微好了一点。

因此等到9月初的时候，他们那边把车机寄过来，我全权负责跟踪这个项目。

# 检测

首先是体验了一下，的确是，莫名其妙的十分十分卡，每次点击起码过3-5秒才会有响应，而且并不会说anr。

按道理每次点击如果过了5秒才响应的话，大概率会出现anr的。

因此很明显，点击得到了响应，但是点击的响应硬生生耗费了5秒左右的时间。



