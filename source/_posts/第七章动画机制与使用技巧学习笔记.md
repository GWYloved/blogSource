---
title: 第七章动画机制与使用技巧学习笔记
date: 2018-01-22 22:47:31
tags: android
---
# Android View动画框架

Animation框架定义了透明度、旋转、缩放和位移几种常见的动画，控制的是整个view，原理是每次绘制视图时view所在的viewgroup中的drawchild函数获取该view的animation的transformation值，然后调用canvas.concat(transformToApply.getMatrix())，通过矩阵换算完成动画帧，如果动画没有完成，就继续调用invalidate()函数，启动下次绘制来驱动动画，从而完成整个动画的绘制。

## 视图动画

视图动画使用简单，效果丰富，提供了四种方式，并提供了animationset动画集合，混合使用多种动画。

1. 透明度动画

为视图增加透明度的变换动画。

```
	AlphaAnimation aa = new AlphaAnimation(0, 1);
	aa.setDuration(1000);
	view.startAnimation(aa);
```	

2. 旋转动画

为视图增加旋转的变换动画。

```
	RotateAnimation ra = new RotateAnimation(0, 360, 100, 100);
	ra.setDuration(1000);
	view.startAnimation(ra);
```

也可以以自身为旋转中心

```
	RotateAnimation ra = new RotateAnimation(0, 360,
		RotateAnimation.RELATIVE_TO_SELF, 0.5F,
		RotateAnimation.RELATIVE_TO_SELF, 0.5F);
```

3. 位移动画

为视图移动时增加位移动画

```
	TranslationAnimation ta = new TranslationAnimation(0, 200, 0, 300);
	ta.setDuration(1000);
	view.startAnimation(ta);
```

4. 缩放动画

为视图的缩放增加动画效果

```
	ScaleAnimation sa = new ScaleAnimation(0, 2, 0, 2);
	sa.setDuration(1000);
	view.startAnimation(sa);
```

也可以以自身为缩放中心

```
	ScaleAnimation sa = new ScaleAnimation(0, 1, 0, 1,
		Animation.RELATIVE_TO_SELF, 0.5F,
		Animation.RELATIVE_TO_SELF, 0.5F);
	sa.setDuration(1000);
	view.startAnimation(sa);
```

5. 动画合集

使用AnimationSet,可以将动画以组合的形式展现出来。

```
	AnimationSet as = new AnimationSet(true);
	as.setDuration(1000);

	AlphaAnimation aa = new AlphaAnimation(0, 1);
	aa.setDuration(1000);
	as.addAnimation(aa);

	TranslateAnimation ta = new TranslateAnimation(0, 100, 0, 200);
	ta.setDuration(1000);
	as.addAnimation(ta);

	view.startAnimation(as);
```

## 属性动画

由于视图动画改变的只是view的显示，而并不是view的属性，会导致一些问题。

1. 	ObjectAnimator

