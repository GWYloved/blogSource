---
title: 关于后台改接口之后前端应该做的事情
date: 2018-03-30 21:45:26
tags: android
---

新到公司，一切都是新鲜的，然而很快问题就来了。

公司后台重构了后台的接口，将原先多层级的接口，改成了扁平化的接口。

这对我是完全没有接触过的挑战。

刚开始我觉得，既然后台改了接口，我就应该把接口部分删了重构，然后将得到的数据结构也重构。但是后来发现，基于原来数据结构上的接口衍生的代码十分庞大，层级比较深，这样重构数据结构基本上等于重构项目了，时间上面不可行。

因此我后来想到一个办法，将原来的数据结构设为set和get，然后将现在获取的数据结构扭成之前的数据结构，需要原先参数的地方，我改成get的方式，将现有的数据结构组合来返回，这样衍生的代码就可以基于之前的数据结构上来运行，可以保证数据结构之上的代码不需要改变。

但是又遇到一个问题，就是项目中很多地方是直接使用数据结构里面的值来进行操作的，而不是set和get，这样我改成set和get，就需要更改使用到该值的地方。当时采取了这种方式，的确代码可运行，而且较为稳定了。

后来在和别人的交流中，得知可以使用一层封装，封装现有的数据结构，变成原来的数据结构，这样也可以。

例如我使用retrofit获取的数据，在rxjava中对observable的执行过程中，直接将原先的数据进行转换，写一个wrapper，然后onnext中返回这个wrapper，这样使用这个接口的部分仍然可以直接使用原来的数据，甚至都不需要使用get和set。

所以当以后遇到这种情况，可以直接使用上述方法，将数据扭合成原先的结构，来进行更改。这样每次更改接口，仅仅需要更改这个wrapper即可。
